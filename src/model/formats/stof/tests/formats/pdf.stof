//
// Copyright 2024 Formata, Inc. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

// If no PDF format, this will get loaded into 'bytes' instead
import './test_stof_pdf.pdf';


#[test]
fn import_pdf() {
    if (lib('Pdf')) {
        assert(self.pdf);
        assert(Data.exists(self.pdf));
        assert(Data.id(self.pdf).len() > 0);
    } else {
        assert(self.bytes);
        assert_eq(typeof self.bytes, 'blob');
    }
}

#[test]
fn types() {
    if (lib('Pdf')) {
        let dta: data = self.pdf as Data<Pdf>;
        assert_eq(typeof dta, 'data');
        assert_eq(typename dta, "Data<Pdf>");
        assert_eq(Data.libname(dta), 'Pdf');
    }
}

#[test]
fn extract_text() {
    if (lib('Pdf')) {
        const text = self.pdf.extract_text();
        assert_eq(text, "Example Stof\nDocument\n");
    }
}

#[test]
fn extract_images() {
    if (lib('Pdf')) {
        const images = self.pdf.extract_images();
        assert_eq(images.len(), 1);
        assert_eq(images[0].get('height'), 500);
        assert_eq(images[0].get('width'), 1250);
    }
}
